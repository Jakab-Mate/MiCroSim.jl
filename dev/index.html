<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Manual · MiCroSim.jl</title><meta name="title" content="Manual · MiCroSim.jl"/><meta property="og:title" content="Manual · MiCroSim.jl"/><meta property="twitter:title" content="Manual · MiCroSim.jl"/><meta name="description" content="Documentation for MiCroSim.jl."/><meta property="og:description" content="Documentation for MiCroSim.jl."/><meta property="twitter:description" content="Documentation for MiCroSim.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="readme/">MiCroSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="readme/">Home</a></li><li class="is-active"><a class="tocitem" href>Manual</a><ul class="internal"><li><a class="tocitem" href="#Reproducibility"><span>Reproducibility</span></a></li><li><a class="tocitem" href="#Create-a-metabolism"><span>Create a metabolism</span></a></li><li><a class="tocitem" href="#Create-a-species-pool"><span>Create a species pool</span></a></li><li><a class="tocitem" href="#Sample-a-species-pool"><span>Sample a species pool</span></a></li><li><a class="tocitem" href="#Simulate-dynamics-using-the-sample"><span>Simulate dynamics using the sample</span></a></li><li><a class="tocitem" href="#Simulate-spatial-dynamics"><span>Simulate spatial dynamics</span></a></li><li><a class="tocitem" href="#Structs"><span>Structs</span></a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="example1/">Initially populated community</a></li><li><a class="tocitem" href="example2/">Initially empty community</a></li><li><a class="tocitem" href="example3/">Populated + invaders</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Manual</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Manual</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Jakab-Mate/MiCroSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Jakab-Mate/MiCroSim.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Reproducibility"><a class="docs-heading-anchor" href="#Reproducibility">Reproducibility</a><a id="Reproducibility-1"></a><a class="docs-heading-anchor-permalink" href="#Reproducibility" title="Permalink"></a></h2><p>The functions in this package (apart from <code>generic_run()</code>) are stochastic, and therefore can lead to different results at different times. To ensure reproducibility, the stochastic functions all have a &quot;seed&quot; parameter, which can be used to initialize a specific instance of a random number generator which arrives at the same results every time.</p><p>Example:</p><pre><code class="language-julia hljs">using MiCroSim
my_seed = 1234
D, W_ba = create_metabolism(seed=my_seed)</code></pre><h2 id="Create-a-metabolism"><a class="docs-heading-anchor" href="#Create-a-metabolism">Create a metabolism</a><a id="Create-a-metabolism-1"></a><a class="docs-heading-anchor-permalink" href="#Create-a-metabolism" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MiCroSim.create_metabolism" href="#MiCroSim.create_metabolism"><code>MiCroSim.create_metabolism</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">create_metabolism(; n_resources::Int64=10, n_levels::Int64=5, energy_yields::String=&quot;Uniform_1&quot;, seed::Int64=1234)</code></pre><p>Generates a universal metabolism</p><p><strong>Optional arguments</strong></p><ul><li><code>n_resources::Int64</code>: Number of possible resources in the system. Default is <code>10</code>.</li><li><code>n_levels::Int64</code>: Number of levels of decomposition in the system. Default is <code>5</code>.</li><li><code>energy_yields::String</code>: The energy difference between two consecutive levels of decomposition. Default is <code>1</code> between all levels. Use &quot;Random&quot; to sample from a uniform distribution between 0 and 2 instead.</li><li><code>rng::Int64</code>: Random number generator seed. Default is <code>1234</code>.</li></ul><p><strong>Output</strong></p><p><code>Stoichiometric matrix, Energy yield matrix</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jakab-Mate/MiCroSim.jl/blob/6a9a10a447413aa511329e825132cb5cd2c750ac/src/generative_functions.jl#L1-L14">source</a></section></article><h2 id="Create-a-species-pool"><a class="docs-heading-anchor" href="#Create-a-species-pool">Create a species pool</a><a id="Create-a-species-pool-1"></a><a class="docs-heading-anchor-permalink" href="#Create-a-species-pool" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MiCroSim.create_species_pool" href="#MiCroSim.create_species_pool"><code>MiCroSim.create_species_pool</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">create_species_pool(D::Matrix; n_families::Int64=5, family_size::Int64=100, dirichlet_hyper::Real=100, between_family_var::Real=0.1, inside_family_var::Real=0.05, h::Real=1, maintenance::Real=0.1, specialist::Real=1, generalist::Real=1, a_dist::Union{Distributions.Sampleable, Nothing}=nothing, k_dist::Union{Distributions.Sampleable, Nothing}=nothing, seed::Int64=1234)</code></pre><p>Create a pool of species by sampling reactions from a matrix denoting all possible reactions.</p><p><strong>Mandatory arguments</strong></p><ul><li><code>D::Matrix</code>: Matrix denoting all possible reactions. A square matrix whose size should be equal to the number of possible resources in the system. All reactions will be deemed possible whose values are non-zero.</li></ul><p><strong>Optional arguments</strong></p><ul><li><code>n_families::Int64</code>: Number of families (groups of functionally similar species) in the species pool. Default is <code>5</code>.</li><li><code>family_size::Int64</code>: Number of species in each family. Default is <code>100</code>.</li><li><code>dirichlet_hyper::Real</code>: Hyperparameter for the Dirichlet distribution that is used for creating the species inside the same family. The higher its value, the more similar they will be. Default is <code>100</code>.</li><li><code>maintenance::Real</code>: The expected cost of maintenance accross all species. Default is <code>0.1</code>.     </li><li><code>between_family_var::Real</code>: Variance of the normal distribution used to sample the maintenance values between families. Default is <code>0.1</code>.</li><li><code>inside_family_var::Real</code>: Variance of the normal distribution used to sample the maintenance values inside families. Default is <code>0.05</code>.</li><li><code>h::Real</code>: Controls the allocation of reaction rates inside species. Default is <code>1</code>.</li><li><code>specialist::Real</code>: The specialist part of the odds ratio specialists:generalists in the pool. Default is <code>1</code>.</li><li><code>generalist::Real</code>: The generalist part of the odds ratio specialists:generalists in the pool. Default is <code>1</code>.</li><li><code>a_dist::Union{Distributions.Sampleable, Nothing}</code>: Distribution to sample the strength of host control. Default is <code>Uniform(0.5, 1.5)</code>.</li><li><code>k_dist::Union{Distributions.Sampleable, Nothing}</code>: Distribution to sample the critical abundance that triggers host control. Default is <code>Uniform(99.999, 100.001)</code>.</li><li><code>spec_constraint::Union{Array{Bool}, Nothing}</code>: Boolean array of resources that specialists can consume. If nothing, first element is false, rest is true. Default is <code>nothing</code>.</li><li><code>rng::Int64</code>: Random number generator seed. Default is <code>1234</code>.</li></ul><p><strong>Output</strong></p><p><code>PoolStruct</code> with the following fields:</p><ul><li><code>pool::Array{Float64, 3}</code>: The matrices describing the metabolisms of the species inside the species pool.</li><li><code>family_ids::Array{Int64}</code>: The family IDs of species</li><li><code>m::Array{Float64}</code>: The maintenance costs of the species</li><li><code>n_reactions::Array{Int64}</code>: The number of reactions of the species</li><li><code>n_splits::Array{Float64}</code>: Reaction repertoire complexity metric of the species</li><li><code>a::Array{Float64}</code>: The strength of host control on the species</li><li><code>k::Array{Float64}</code>: The critical abundance that triggers host control on the species</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jakab-Mate/MiCroSim.jl/blob/6a9a10a447413aa511329e825132cb5cd2c750ac/src/generative_functions.jl#L56-L88">source</a></section></article><h2 id="Sample-a-species-pool"><a class="docs-heading-anchor" href="#Sample-a-species-pool">Sample a species pool</a><a id="Sample-a-species-pool-1"></a><a class="docs-heading-anchor-permalink" href="#Sample-a-species-pool" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MiCroSim.sample_pool" href="#MiCroSim.sample_pool"><code>MiCroSim.sample_pool</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sample_pool(p::PoolStruct, n_species::Int64, n_invaders::Int64; seed::Int64=1234)</code></pre><p>Samples species from a species pool</p><p><strong>Mandatory arguments</strong></p><ul><li><code>p::PoolStruct</code>: A pool struct containing the pool of species.</li><li><code>n_species::Int64</code>: Number of species initially present in the habitat.</li><li><code>n_invaders::Int64</code>: Number of invading species.</li></ul><p><strong>Optional arguments</strong></p><ul><li><code>seed::Int64</code>: Random number generator seed. Default is <code>1234</code>.</li><li><code>n_comms::Int64</code>: Number of communities. Default is <code>1</code>.</li><li><code>ph::Bool</code>: Whether to sample pH values. If true, optimal pH value is sampled from the (0, 14) range for each species. </li></ul><p>Default is <code>false</code>, where optimal pH is set to 7.0 for all species.</p><p><strong>Output</strong></p><p><code>SampleStruct</code> with the following fields:</p><ul><li><code>n_species::Int64</code>: Number of species initially present in the habitat.</li><li><code>n_invaders::Int64</code>: Number of invading species.</li><li><code>C::Array{Float64, 3}</code>: The matrices describing the metabolism of the sampled species.</li><li><code>family_ids::Array{Int64}</code>: The family IDs of the sampled species.</li><li><code>m::Array{Float64}</code>: The maintenance costs of the sampled species.</li><li><code>n_reactions::Array{Int64}</code>: The number of reactions of the sampled species.</li><li><code>n_splits::Array{Float64}</code>: Reaction repertoire complexity metric of the sampled species.</li><li><code>species_abundance::Array{Float64}</code>: The initial abundances of the sampled species.</li><li><code>resource_abundance::Array{Float64}</code>: The initial abundances of resources.</li><li><code>a::Array{Float64}</code>: The strength of host control on the sampled species.</li><li><code>k::Array{Float64}</code>: The critical abundance that triggers host control on the sampled species.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jakab-Mate/MiCroSim.jl/blob/6a9a10a447413aa511329e825132cb5cd2c750ac/src/sample_pool.jl#L1-L30">source</a></section></article><h2 id="Simulate-dynamics-using-the-sample"><a class="docs-heading-anchor" href="#Simulate-dynamics-using-the-sample">Simulate dynamics using the sample</a><a id="Simulate-dynamics-using-the-sample-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-dynamics-using-the-sample" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MiCroSim.generic_run" href="#MiCroSim.generic_run"><code>MiCroSim.generic_run</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generic_run(sample::SampleStruct;
   D=nothing,
   W_ba=nothing,
   path=homedir(),
   t_span=(0, 1000),
   t_inv=25.0,
   t_inv_0=100.0,
   cutoff=0.0001,
   phi=0.1,
   eta=0.1,
   tau=nothing,
   alpha=nothing,
   plot=true,
   host_regulation=true)</code></pre><p>Run the model with the given parameters and sample by solving a set of ODEs using the KenCarp4 solver.</p><p><strong>Mandatory arguments</strong></p><ul><li><code>sample::SampleStruct</code>: A sample struct containing the initial conditions and parameters for the model.</li></ul><p><strong>Recommended but optional arguments</strong></p><ul><li><code>D::Union{Nothing, Matrix{Int64}}</code>: The stoichiometric matrix for the model. If not supplied, a default matrix will be created.</li><li><code>W_ba::Union{Nothing, Matrix{Float64}}</code>: The energy yield matrix for the model. If not supplied, a default matrix will be created.</li><li><code>path::String</code>: The path to save the output plots. Default is <code>homedir()</code>.</li><li><code>t_span::Tuple{Int64, Int64}</code>: The time span for the simulation. Default is <code>(0, 1000)</code>.</li></ul><p><strong>Optional arguments</strong></p><ul><li><code>t_inv::Float64</code>: The time between the introduction of two subsequent invading species. Default is <code>25.0</code>.</li><li><code>t_inv_0::Float64</code>: The time at which the first invading species is introduced. Default is <code>100.0</code>.</li><li><code>cutoff::Float64</code>: The abundance threshold under which a species is considered extinct and its abundance is set to 0. Default is <code>0.0001</code>.</li><li><code>phi::Float64</code>: The strength of the additional maintenance costs based on the complexity of a the reaction repertoires of species. Default is <code>0.1</code>.</li><li><code>eta::Float64</code>: The strength of the additional maintenance costs based on the number of reactions of species. Default is <code>0.1</code>.</li><li><code>tau::Union{Vector{Float64}, Nothing}</code>: Controls the replenisment/depletion rates of resources from/into the outter environment. Default is <code>1.0</code> for all reasources.</li><li><code>alpha::Union{Vector{Float64}, Nothing}</code>: The availability of resources in the outer environment. Default is <code>100.0</code> for the first resource and 0.0 for the rest.</li><li><code>plot::Bool</code>: Whether to generate plots of the simulation. Default is <code>true</code>.</li><li><code>host_regulation::Bool</code>: Whether to include host regulation in the model. Default is <code>true</code>.</li></ul><p><strong>Output</strong></p><p>Returns time series data in a SummarizedExperiment (SE) data container, which can be used for a variety of analyses. For details, see <a href="https://github.com/JuliaTurkuDataScience/MicrobiomeAnalysis.jl">MicrobiomeAnalysis.jl</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jakab-Mate/MiCroSim.jl/blob/6a9a10a447413aa511329e825132cb5cd2c750ac/src/run_functions.jl#L1-L41">source</a></section></article><h2 id="Simulate-spatial-dynamics"><a class="docs-heading-anchor" href="#Simulate-spatial-dynamics">Simulate spatial dynamics</a><a id="Simulate-spatial-dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-spatial-dynamics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MiCroSim.spatial_run" href="#MiCroSim.spatial_run"><code>MiCroSim.spatial_run</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">spatial_run(n_comms::Int64, sample::SampleStruct;
    ph_list::Union{Nothing, Vector{Float64}}=nothing,
    ph_strength=1.0,
    D_species=0.1,
    D_resources=0.1,
    A_species=0.1,
    A_resources=0.1,
    D=nothing,
    W_ba=nothing,
    path=homedir(),
    t_span=(0, 1000),
    t_inv=25.0,
    t_inv_0=100.0,
    cutoff=0.0001,
    phi=0.1,
    eta=0.1,
    tau=nothing,
    alpha=nothing,
    plot=true,
    host_regulation=true)</code></pre><p>Run the spatially extended version of the model, where a set of communities are simulated. The communities resemble different sections of the gut, where resources and invaders appear in the first community and can spread to the other communities through diffusion and advection.</p><p><strong>Mandatory arguments</strong></p><ul><li><code>n_comms::Int64</code>: The number of communities to simulate.</li><li><code>sample::SampleStruct</code>: A sample struct containing the initial conditions and parameters for the model.</li></ul><p><strong>Additional arguments</strong></p><ul><li><code>D_species::Float64</code>: The diffusion coefficient for species. Default is <code>0.1</code>.</li><li><code>D_resources::Float64</code>: The diffusion coefficient for resources. Default is <code>0.1</code>.</li><li><code>A_species::Float64</code>: The advection coefficient for species. Default is <code>0.1</code>.</li><li><code>A_resources::Float64</code>: The advection coefficient for resources. Default is <code>0.1</code>.</li><li><code>ph_strength::Float64</code>: The strength of the pH effect on growth. Default is <code>1.0</code>.</li><li><code>ph_list::Union{Nothing, Vector{Float64}}</code>: A list of pH values for each community. If not supplied, the default pH value is 7.0.</li></ul><p><strong>Output</strong></p><p>Returns a dictionary of SummarizedExperiment (SE) data containers</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jakab-Mate/MiCroSim.jl/blob/6a9a10a447413aa511329e825132cb5cd2c750ac/src/run_functions.jl#L93-L132">source</a></section></article><h2 id="Structs"><a class="docs-heading-anchor" href="#Structs">Structs</a><a id="Structs-1"></a><a class="docs-heading-anchor-permalink" href="#Structs" title="Permalink"></a></h2><p>If you wish to use the structures <em>PoolStruct</em> or <em>SampleStruct</em>, you will need to specify the module name as well, since these are not exported:</p><ul><li><code>MiCroSim.PoolStruct()</code></li><li><code>MiCroSim.SampleStruct()</code></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="readme/">« Home</a><a class="docs-footer-nextpage" href="example1/">Initially populated community »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 18 September 2024 08:47">Wednesday 18 September 2024</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
