<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · MiCroSim.jl</title><meta name="title" content="Home · MiCroSim.jl"/><meta property="og:title" content="Home · MiCroSim.jl"/><meta property="twitter:title" content="Home · MiCroSim.jl"/><meta name="description" content="Documentation for MiCroSim.jl."/><meta property="og:description" content="Documentation for MiCroSim.jl."/><meta property="twitter:description" content="Documentation for MiCroSim.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>MiCroSim.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#A-general-purpose-microbial-consumer-resource-model-that-outputs-simulated-data-in-the-SummarizedExperiment-(SE)-format."><span>A general-purpose microbial consumer-resource model that outputs simulated data in the SummarizedExperiment (SE) format.</span></a></li><li><a class="tocitem" href="#Applicability"><span>Applicability</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Workflow"><span>Workflow</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Reproducibility"><span>Reproducibility</span></a></li><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li><li><a class="tocitem" href="#Design-your-own-metabolism"><span>Design your own metabolism</span></a></li><li><a class="tocitem" href="#Acknowledgements"><span>Acknowledgements</span></a></li><li><a class="tocitem" href="#Funding"><span>Funding</span></a></li><li><a class="tocitem" href="#Contact-me"><span>Contact me</span></a></li></ul></li><li><a class="tocitem" href="../">Manual</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../example1/">Initially populated community</a></li><li><a class="tocitem" href="../example2/">Initially empty community</a></li><li><a class="tocitem" href="../example3/">Populated + invaders</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Jakab-Mate/MiCroSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Jakab-Mate/MiCroSim.jl/blob/main/README.md" title="View source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Microbial-Cross-feeding-Community-Simulator"><a class="docs-heading-anchor" href="#Microbial-Cross-feeding-Community-Simulator">Microbial Cross-feeding Community Simulator</a><a id="Microbial-Cross-feeding-Community-Simulator-1"></a><a class="docs-heading-anchor-permalink" href="#Microbial-Cross-feeding-Community-Simulator" title="Permalink"></a></h1><p><a href="https://github.com/Jakab-Mate/MiCroSim.jl/actions/workflows/CI.yml?query=branch%3Amain"><img src="https://github.com/Jakab-Mate/MiCroSim.jl/actions/workflows/CI.yml/badge.svg?branch=main" alt="Build Status"/></a></p><h2 id="A-general-purpose-microbial-consumer-resource-model-that-outputs-simulated-data-in-the-SummarizedExperiment-(SE)-format."><a class="docs-heading-anchor" href="#A-general-purpose-microbial-consumer-resource-model-that-outputs-simulated-data-in-the-SummarizedExperiment-(SE)-format.">A general-purpose microbial consumer-resource model that outputs simulated data in the SummarizedExperiment (SE) format.</a><a id="A-general-purpose-microbial-consumer-resource-model-that-outputs-simulated-data-in-the-SummarizedExperiment-(SE)-format.-1"></a><a class="docs-heading-anchor-permalink" href="#A-general-purpose-microbial-consumer-resource-model-that-outputs-simulated-data-in-the-SummarizedExperiment-(SE)-format." title="Permalink"></a></h2><p>This project offers a quick and easy method for simulating microbial community dynamics based solely on their metabolic interactions. The model represents distinct microbial species as matrices that describe their net conversion rates in the form <em>A -&gt; nB</em>, where <em>A</em> is the metabolite consumed, <em>B</em> is the metabolite excreted into a shared environment, and <em>n</em> is a stoichiometric constant. Additionally, the species housing the above net conversion (or reaction), will have generated some value (energy) during the process, which contributes to its own growth. Once excreted, metabolite <em>B</em> may be utilized by a different species, enabling cross-feeding (syntrophy) between the populations present in the community. The model incorporates a feeding term that describes the type and amount of resources that flow into the system per unit time. All observed growth in the community can be derived from this inflow of resources: some species will be able to directly consume the resources flowing into the habitat (as a renewable or depletable resource), while the preferred resources for other species will be the byproducts of the reaction(s) performed by different species.</p><h2 id="Applicability"><a class="docs-heading-anchor" href="#Applicability">Applicability</a><a id="Applicability-1"></a><a class="docs-heading-anchor-permalink" href="#Applicability" title="Permalink"></a></h2><ul><li><p><strong>Simulate the growth of an initially populated microbial community and find the equilibrium abundances</strong></p></li><li><p><strong>Simulate the succession of an initially empty microbial habitat where colonizers appear one by one</strong></p></li><li><p><strong>Simulate the resilience of a microbial community against invaders appearing one by one</strong></p></li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>To install MiCroSim.jl directly from the github repository, use:</p><pre><code class="language-julia hljs">using Pkg
Pkg.add(url=&quot;https://github.com/Jakab-Mate/MiCroSim.jl.git&quot;)</code></pre><h2 id="Workflow"><a class="docs-heading-anchor" href="#Workflow">Workflow</a><a id="Workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Workflow" title="Permalink"></a></h2><p>The functions in this package rely on each other&#39;s outputs, so generally you will want to use them in the following order:</p><ol><li><p><strong>create_metabolism(...)</strong>&lt;span style=&quot;display:inline-block; width: 56px;&quot;&gt;&lt;/span&gt;Generates the set of possible reactions (net conversions)</p></li><li><p><strong>create<em>species</em>pool(...)</strong>&lt;span style=&quot;display:inline-block; width: 48px;&quot;&gt;&lt;/span&gt;Generates the pool of possible species by sampling from the possible reactions</p></li><li><p><strong>sample_pool(...)</strong>&lt;span style=&quot;display:inline-block; width: 100px;&quot;&gt;&lt;/span&gt;Chooses the species that will appear in the simulation by sampling from the species pool</p></li><li><p><strong>generic_run(...)</strong>&lt;span style=&quot;display:inline-block; width: 107px;&quot;&gt;&lt;/span&gt;Takes the sampled species and simulates their dynamics based on a set of ODEs</p></li></ol><p>Detailed instructions for using each function can be found in their dedicated sections.</p><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><h3 id="create_metabolism()"><a class="docs-heading-anchor" href="#create_metabolism()"><code>create_metabolism()</code></a><a id="create_metabolism()-1"></a><a class="docs-heading-anchor-permalink" href="#create_metabolism()" title="Permalink"></a></h3><p>This function generates the set of all possible reactions, or in other words a universal metabolism. Each reaction is characterized by 4 attributes: the metabolite that is being consumed, the metabolite that is being produced, the stoichiometric constant (unit resource produced per unit resource consumed), and the energy that the species gains per unit resource consumed. </p><p><code>create_metabolism()</code> outputs two matrices that hold the stoichiometric constants and the energy gains respectively. Each of these matrices is of size <em>RxR</em>, where <em>R</em> is the number of different resources, and each entry inside them corresponds to a specific reaction, where the column index indicates the resource being consumed, and the row index indicates the resource being produced. Importantly, the positions of zeros in these two matrices must align, and those reactions will not be possible.</p><p>To simulate a gut-microbiome scenario, where most reactions are catabolic, <code>create_metabolism()</code> operates under the following assumptions:</p><ul><li>Resources can be grouped into different levels of decomposition, based on their energy content</li><li>Reactions will always yield some energy, meaning that the resource produced will always be of a lower level (more decomposed) than the resource consumed</li></ul><p><strong>Optional parameters</strong></p><ul><li>***n_resources:*** The number of different resources in the network, which determines the size of the output matrices. <em>Default value is 10</em></li><li>***n<em>levels:*** The number of levels of decomposition. Must be smaller or equal to *n</em>resources<em>, because each level will have at least one resource belonging to it. The lowest and the highest levels can only have one resource, and thus, the remaining resources will be of intermediate levels. *Default value is 5</em></li><li>***energy<em>yields:*** Either &quot;Uniform</em>1&quot; or &quot;Random&quot;. Denotes the energy difference between levels of decomposition, which can either be uniformly 1, or a random number whose expected value is 1. <em>Default is &quot;Uniform_1&quot;</em></li><li>***seed:*** See section Reproducibility</li></ul><h3 id="create_species_pool()"><a class="docs-heading-anchor" href="#create_species_pool()"><code>create_species_pool()</code></a><a id="create_species_pool()-1"></a><a class="docs-heading-anchor-permalink" href="#create_species_pool()" title="Permalink"></a></h3><p>This function generates a pool of species, a subset of which will be used for simulations later. The species pool consists of different families, whose members are functionally similar to each other. Family members will always possess the same set of reactions, with varied reaction rates. Each family has a &quot;prior&quot; or holotype, whose reaction rates are vectorized and used as the density parameter of a Dirichlet distribution. The reaction rates of family members are then sampled from this Dirichlet distribution. Families can either be specialist or generalist. Specialist families will have 2-3 reactions, while generalists will have 4-5. </p><p>Returning to our gut-microbiome scenario, we have introduced host regulation, the extent of which we assume to be identical in the members of the same family. We make the assumption that when the population of a microbial species reaches a certain size, the host will recognize this species as a potential threat, and start regulating its growth. Regulation is imposed according to the following equation:</p><p><img src="../images/host_regulation.png" alt="formula2"/></p><p>where <em>G_i</em> is the growth rate of species <em>i</em> without host regulation, <em>a</em> controls the strength/speed of host regulation, <em>k</em> controls the critical population size and <em>N_i</em> is the population size of species <em>i</em>.</p><p><strong>Mandatory parameters</strong></p><ul><li>***D:*** Matrix that denotes the possible reactions to sample from. The stoichiometric matrix and the energy_yield matrix are equally suitable for this role. Any non-zero position in the matrix will be deemed possible.</li></ul><p><strong>Optional parameters</strong></p><ul><li>***n_families:*** The number of families (functional groups) to create. <em>Default is 5</em></li><li>***family<em>size:*** The number of members inside a family. To exclude families from your simulations, set this parameter to 1, which will result in a number of functionally independent species equal to *n</em>families<em>. *Default is 100</em></li><li>***dirichlet_hyper:*** The higher the value of this parameter, the more similar species will be inside the same family. <em>Default is 100</em></li><li>***maintenance:*** The average cost of maintenance throughout the community. <em>Default is 0.1</em> </li><li>***between<em>family</em>var:*** The variance of maintenance between families. <em>Default is 0.1</em></li><li>***inside<em>family</em>var:*** The variance of maintenance between members of the same family. <em>Default is 0.05</em> </li><li>***specialist:*** Integer value that will be interpreted relative to <em>generalist</em>. <em>Default is 1</em></li><li>***generalist:*** Integer value. The expected ratio of generalist and specialist families in the species pool will be equal to the ratio of these parameters. <em>Default is 1</em></li><li>***a_dist:*** Parameter of type <em>Distributions.Sampleable</em>, which controls the speed of host regulation. <em>Default is Uniform(0.5, 1.5)</em></li><li>***k_dist:*** Parameter of type <em>Distributions.Sampleable</em>, which controls the population size where the host starts regulating growth. <em>Default is Uniform(99.999, 100.001)</em></li><li>***h:*** Parameter that controls the allocation of reaction rates. Before applying the effect of <em>h</em>, reaction rates in a single species will always sum to 1. These values are then divided by the sum of the reaction rates raised to the power of <em>h</em>. Values between 0-1 can be expected to favor specialists, while values above 1 can be expected to favor generalists.</li><li>***seed:*** See section Reproducibility</li></ul><p><strong>Output</strong></p><p>Output is a single object of type ***PoolStruct***. To access this type, use <code>MiCroSim.PoolStruct()</code>. This structure will have the following fields:</p><ul><li>***pool:*** An array of size <em>n<em>resources x n</em>resources x (n<em>families x family</em>size)</em> which contains the matrices of all species inside the species pool</li></ul><p>The rest of the fields are all attribute vectors of size <em>(n<em>families x family</em>size)</em></p><ul><li>***family_ids:*** Denotes the family of each species.</li><li>***m:*** Denotes the maintenance values of each species.</li><li>***n_reactions:*** Denotes the number of reactions that each species houses</li><li>***n_splits:*** Denotes cumulative complexity of each species&#39; reaction repertoire</li><li>***a:*** Denotes host regulation speed for each species</li><li>***k:*** Denotes critical population size for each species</li></ul><h3 id="sample_pool()"><a class="docs-heading-anchor" href="#sample_pool()"><code>sample_pool()</code></a><a id="sample_pool()-1"></a><a class="docs-heading-anchor-permalink" href="#sample_pool()" title="Permalink"></a></h3><p>This function randomly chooses some species matrices from a pool and takes the corresponding subset of the attribute vectors in the <em>PoolStruct</em>. It also assigns initial abundances (values between 0 and 1) for the species in the sample and all of the different resources.</p><p><strong>Mandatory parameters</strong></p><ul><li>***p:*** A <em>PoolStruct</em></li><li>***n_species:*** Number of species initially present in the community</li><li>***n_invaders:*** Number of species that will appear successively in the community</li></ul><p><strong>Optional parameters</strong></p><ul><li>***seed:*** See section Reproducibility</li></ul><p><strong>Output</strong> Output is a single object of type ***SampleStruct***. To access this type, use <code>MiCroSim.SampleStruct()</code>. This structure will have the following fields:</p><ul><li>***n_species:*** Feed forward parameter value</li><li>***n_invaders:*** Feed forward parameter value</li><li>***C:*** Sample of species matrices </li><li>***family_ids:*** Corresponding family ID-s</li><li>***m:*** Corresponding maintenance costs</li><li>***n_reactions:*** Corresponding number of reactions</li><li>***n_splits:*** Corresponding complexity metric</li><li>***a:*** Corresponding host regulation speed</li><li>***k:*** Corresponding critical population size</li><li>***species_abundance:*** Initial abundances for each of the sampled species</li><li>***resource_abundance:*** Initial abundances for each resource</li></ul><h3 id="generic_run()"><a class="docs-heading-anchor" href="#generic_run()"><code>generic_run()</code></a><a id="generic_run()-1"></a><a class="docs-heading-anchor-permalink" href="#generic_run()" title="Permalink"></a></h3><p>This function takes a sample and solves a set of Ordinary Differential Equations (ODEs) to simulate the community dynamics. Along with the sample there are several tradeoff-s and other parameters controlling the simulation, whose values can be set here. In order to better understand what these parameters do, let&#39;s look at the ODEs:</p><p>Species dynamics is given by:</p><p><img src="../images/species_dynamics.png" alt="formula3"/></p><p>&lt;a id=&quot;species&quot;&gt;&lt;/a&gt; where <em>delta_w</em> is the energy yield matrix <em>C</em> are the species matrices, <em>R</em> are the resource abundances, <em>m</em> are the default maintenance values, <em>E</em> are the complexity metrics, <em>eta</em> describes how the complexity metrics contribute to maintenance costs, <em>F</em> are the number of reactions, <em>phi</em> describes how the number of reactions contribute to maintenance costs and <em>N</em> are the species abundances.</p><p>Resource dynamics is as follows:</p><p><img src="../images/resource_dynamics.png" alt="formula4"/></p><p>&lt;a id=&quot;resource&quot;&gt;&lt;/a&gt; where <span>$K$</span> are the inflow rates, <em>tau</em> are the dilution rates, <em>D</em> is the stoichiometric matrix and the rest of the parameters are the same as above. The first term describes the inflow and depletion of resources from and into an outer environment, the second (negative) term describes consumption and the last (positive) term describes production.</p><p><strong>Mandatory parameters</strong></p><ul><li>***sample:*** A <em>SampleStruct</em></li></ul><p><strong>Recommended but optional parameters</strong></p><ul><li>***path:*** Specifies the output folder for the results of the simulation. <em>Default is <code>homedir()</code></em></li><li>***t_span:*** Tuple(Int64, Int64) that specifies the starting and ending time points for the simulation. <em>Default is (0, 1000)</em></li><li>***D:*** Stoichiometric matrix. <em>Defaults to a random matrix generated by <code>create_metabolism()</code></em></li><li>***W<em>ba:*** Energy yield matrix. *Defaults to a random matrix generated by `create</em>metabolism()`*</li></ul><p>If either one of <em>D</em> or <em>W_ba</em> is missing, a warning is raised and both matrices will be given by <code>create_metabolism()</code> to ensure compatibility</p><p><strong>Optional parameters</strong></p><ul><li>***t_inv:*** Specifies the time between the appearance of two consecutive invading species. <em>Default is 25.0</em></li><li>***t<em>inv</em>0:*** Specifies the time of the first invasion <em>Default is 100.0</em></li><li>***cutoff:*** Specifies the abundance threshold below which a species can be considered extinct. <em>Default is 0.0001</em></li><li>***phi:*** See <em>phi</em> in <a href="#species">species dynamics</a>. <em>Default is 0.1</em></li><li>***eta:*** See <em>eta</em> in <a href="#species">species dynamics</a>. <em>Default is 0.1</em></li><li>***tau:*** See <em>tau</em> in <a href="#resource">resource dynamics</a>. <em>Defaults to a vector of length n_resources, where the value corresponding to the first (highest energy) resource is 100.0 and the rest are 0.0</em></li><li>***alpha:*** See <em>K</em> in <a href="#resource">resource dynamics</a>. <em>Defaults to a vector of length n_resources, where all elements are 1.0</em></li><li>***plot:*** Boolean parameter that controls whether to plot the results. <em>Defaults to True</em></li><li>***host_regulation:*** Boolean parameter that controls whether host regulation is turned on. <em>Defaults to True</em></li></ul><p><strong>Output</strong> Returns time series data in a SummarizedExperiment (SE) data container, which can be used for a variety of analyses. For details, see <a href="https://github.com/JuliaTurkuDataScience/MicrobiomeAnalysis.jl">MicrobiomeAnalysis.jl</a></p><h2 id="Reproducibility"><a class="docs-heading-anchor" href="#Reproducibility">Reproducibility</a><a id="Reproducibility-1"></a><a class="docs-heading-anchor-permalink" href="#Reproducibility" title="Permalink"></a></h2><p>The functions in this package (apart from <code>generic_run()</code>) are stochastic, and therefore can lead to different results at different times. To ensure reproducibility, the stochastic functions all have a &quot;seed&quot; parameter, which can be used to initialize a specific instance of a random number generator which arrives at the same results every time.</p><p>Example:</p><pre><code class="language-julia hljs">using MiCroSim
my_seed = 1234
D, W_ba = create_metabolism(seed=my_seed)</code></pre><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><h3 id="Find-equilibrium-community-composition-of-initially-populated-community"><a class="docs-heading-anchor" href="#Find-equilibrium-community-composition-of-initially-populated-community">Find equilibrium community composition of initially populated community</a><a id="Find-equilibrium-community-composition-of-initially-populated-community-1"></a><a class="docs-heading-anchor-permalink" href="#Find-equilibrium-community-composition-of-initially-populated-community" title="Permalink"></a></h3><pre><code class="language-julia hljs">using MiCroSim

n_resources = 12 # set the number of resources

# create universal metabolism of a 12 resource system
D, W_ba = create_metabolism(n_resources=n_resources)

# generate a pool of 5 families, each with 10 members
pool = create_species_pool(D, n_families=5, family_size=10)

# sample 25 initially present species from the pool
sample = sample_pool(pool, 25,  0)

# simulate dynamics with host regulation turned off
out = generic_run(sample, D=D, W_ba=W_ba, phi=0.0, t_span=(0, 200), host_regulation=false, path=&quot;full/path/to/output/folder/&quot;)

# since plot is set to true by default, you will find some figures illustrating your simulation results is your specified directory</code></pre><p>Since there is no host regulation, and only a single summplied resource (default), only the species with the most favorable metabolic profile survives, as illustrated on the plot below:</p><p><img src="../images/example1.png" alt="img1"/></p><p>With host regulation enabled, multiple species can survive:</p><p><img src="../images/example1_2.png" alt="img2"/></p><p>Although in this case, we might want to midify t_span becasue it takes longer to reach the equilibrium state</p><h3 id="Introducing-colonizers-into-an-initially-empty-habitat"><a class="docs-heading-anchor" href="#Introducing-colonizers-into-an-initially-empty-habitat">Introducing colonizers into an initially empty habitat</a><a id="Introducing-colonizers-into-an-initially-empty-habitat-1"></a><a class="docs-heading-anchor-permalink" href="#Introducing-colonizers-into-an-initially-empty-habitat" title="Permalink"></a></h3><pre><code class="language-julia hljs">using MiCroSim

n_resources = 15
# let&#39;s supply multiple resources extrenally this time
supplied_resources = 3

# create vector of resource availabilities
alpha = vcat(fill(100.0, supplied_resources), fill(0.0, n_resources - supplied_resources))

D, W_ba = create_metabolism(n_resources=n_resources)
pool = create_species_pool(D)

# start from an empty community, and add 50 species one by one
sample = sample_pool(pool, 0,  40)

# simulate dynamics using the given resource availability
out = generic_run(sample, D=D, W_ba=W_ba, alpha=alpha, host_regulation=false, t_span=(0, 1200))

#figures will now appear in homedir, since we didn&#39;t specify a path</code></pre><p>The resulting species dynamics is illustrated below:</p><p><img src="../images/example2_abu.png" alt="img3"/></p><p>Above the changes in abundance, we also track some valueable information about the species present in the network such as number of reactions or complexity of reaction repertoires. This is enabled by the rowdata fields of the SummarizedExperiment output object, which is used to automatically create plots.</p><p>For example, the figure below shows the Metabolic Capacity Index representative of the community as the colonization progresses. This is calculated from the number of reactions that each species houses. These measures could be useful for relating the simulation results to real world experiments such as that of <a href="https://www.researchsquare.com/article/rs-2885808/v1">Marcos et al. (2023)</a>.</p><p><img src="../images/example2_MCI.png" alt="img4"/></p><h3 id="Check-the-robustness-of-an-equilibrium-state-community-against-invaders"><a class="docs-heading-anchor" href="#Check-the-robustness-of-an-equilibrium-state-community-against-invaders">Check the robustness of an equilibrium state community against invaders</a><a id="Check-the-robustness-of-an-equilibrium-state-community-against-invaders-1"></a><a class="docs-heading-anchor-permalink" href="#Check-the-robustness-of-an-equilibrium-state-community-against-invaders" title="Permalink"></a></h3><pre><code class="language-julia hljs">using MiCroSim

n_resources = 16
supplied_resources = 2
alpha = vcat(fill(100.0, supplied_resources), fill(0.0, n_resources - supplied_resources))

# Create a metabolism with 8 levels of decomposition
n_levels = 8 
D, W_ba = create_metabolism(n_resources=n_resources, n_levels=n_levels)

pool = create_species_pool(D, n_families=10, family_size=20)

# Start from a populated community, and add 80 invading species
sample = sample_pool(pool, 20,  80)

# Simulate dynamics of initial community until t=1000 and then start adding invaders 
out = generic_run(sample, D=D, W_ba=W_ba, alpha=alpha, t_inv=25.0, t_inv_0=1000.0, t_span=(0, 4000), host_regulation=false)</code></pre><p>The fruitless efforts of invading species are best illustrated on the MCI plot. When invasion events stop, the community returns to the initial equilibrium state.</p><p><img src="../images/example3_MCI.png" alt="img5"/></p><h2 id="Design-your-own-metabolism"><a class="docs-heading-anchor" href="#Design-your-own-metabolism">Design your own metabolism</a><a id="Design-your-own-metabolism-1"></a><a class="docs-heading-anchor-permalink" href="#Design-your-own-metabolism" title="Permalink"></a></h2><p>The best way to contribute to this project is by curating universal metabolisms in the form of stoichiometric and energy yield matrices. Admittedly, the reaction systems that may arise from <code>create_metabolism()</code> are limited, but more complex metabolic networks can also be implemented, for example modeling synthetic processes by setting energy yields negative (that is, a species invests into producing a metabolite). Furthermore, pathway databases such as KEGG coupled with microbial whole genome data open the possibility for deriving net conversions from real-world experiments.</p><h2 id="Acknowledgements"><a class="docs-heading-anchor" href="#Acknowledgements">Acknowledgements</a><a id="Acknowledgements-1"></a><a class="docs-heading-anchor-permalink" href="#Acknowledgements" title="Permalink"></a></h2><p>This project has benefited from contributions and insights of the following individuals and groups:</p><ul><li><p><strong>István Scheuring</strong> and <strong>Gergely Boza</strong> from the Centre for Ecological Research, Budapest, provided essential theoretical guidance for the model&#39;s development.</p></li><li><p><strong>Giulio Benedetti</strong> and the <a href="https://datascience.utu.fi/"><strong>TurkuDataScience</strong></a> team form the University of Turku, Turku, were instrumental in setting up and optimizing the Julia package.</p></li><li><p>The model was inspired by the work of <a href="https://doi.org/10.1126/science.aat1168">Goldford et al. (2018)</a>.</p></li></ul><h2 id="Funding"><a class="docs-heading-anchor" href="#Funding">Funding</a><a id="Funding-1"></a><a class="docs-heading-anchor-permalink" href="#Funding" title="Permalink"></a></h2><p><strong>This project received funding from the European Union’s Horizon 2020 research and innovation programme (under grant agreement 952914; FindingPheno).</strong></p><h2 id="Contact-me"><a class="docs-heading-anchor" href="#Contact-me">Contact me</a><a id="Contact-me-1"></a><a class="docs-heading-anchor-permalink" href="#Contact-me" title="Permalink"></a></h2><p>For inquiries and bug reports, contact Jakab Máté: mate.jakab@ecolres.hu</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="../">Manual »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Friday 28 June 2024 15:28">Friday 28 June 2024</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
